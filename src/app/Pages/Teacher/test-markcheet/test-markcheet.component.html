<section class="wrapper">
    <!--overview start-->
    <div class="row">
        <div class="col-lg-12">
            <h3 class="page-header"><i class="fa fa-table"></i>Test Markscheet</h3>
            <!-- <a style="float: right;border-radius: 0px;" class="btn btn-primary" title="Bootstrap 3 themes generator"
                data-toggle="modal" data-target="#addNewTestModal">
                <span class="fa fa-plus-circle">
                </span>
                Add Test
            </a> -->
            <ol class="breadcrumb">
                <li><i class="fa fa-home"></i><a href="index.html">Home</a></li>
                <li><i class="fa fa-table"></i>Markscheet</li>
            </ol>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <section class="panel">
                <div class="cheetheader">
                    <div class="row">
                        <div class="col-lg-12">
                            <label>Test: &nbsp; <strong> {{testInfo.name}}</strong></label>
                            <label style="margin-left: 30%;">Points Average:&nbsp; <strong> {{getAverageForTest()}} </strong></label>
                            <button class="btn btn-primary" style="float: right;width: 160px;" data-toggle="modal"
                                data-target="#importCSVModal">
                                <span class="fa fa-upload"></span>
                                Import Result(CSV)
                            </button>
                        </div>
                        <div class="col-lg-12">
                            <label>Date: &nbsp; <strong> {{testInfo.date | dateformat}}</strong></label>
                        </div>
                        <div class="col-lg-12" *ngIf="testInfo.subject">
                            <label>Subject: &nbsp;
                                <strong>{{testInfo.subject.title}}({{testInfo.subject.s_id}})</strong></label>
                            <!--  -->
                            <div class="dropdown" style="float: right;" aria-haspopup="true" aria-expanded="false">
                                <button class="btn btn-success dropdown-toggle"  data-toggle="dropdown"
                                    style="float: right;width: 160px;">
                                    <span class="fa fa-download"></span>
                                    Export Result
                                </button>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                    <button class="btn" style="float: right;" (click)="exportCSV()">
                                        <span class="fa fa-download"></span>
                                        Export Result(CSV)
                                    </button>
                                    <button class="btn" style="float: right;" (click)="exportPDF()">
                                        <span class="fa fa-download"></span>
                                        Export Result(PDF)
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <table class="table table-striped table-advance table-hover">
                    <tbody>
                        <tr>
                            <th>Student ID</th>
                            <th>Name</th>
                            <th>Points</th>
                            <th style="text-align: right;">Action</th>
                        </tr>
                        <tr *ngFor="let ms of markSheet">
                            <td>{{ms.user_id}}</td>
                            <td>{{ms.name}}</td>
                            <td>{{ms.result}}</td>
                            <td style="text-align: right;">
                                <div class="btn-group">
                                    <a class="btn btn-success" data-toggle="modal" (click)="selectedTest(ms)"
                                        data-target="#editSingleResult"><i class="fa fa-edit"></i></a>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </div>
    </div>
</section>

<!-- Import Test result CSVn Modal -->
<div class="modal fade" id="importCSVModal" tabindex="-1" role="dialog" aria-labelledby="importCSVModal"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-header">
            <h5 class="modal-title">Choose file</h5>
            <!-- <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button> -->
        </div>
        <div class="modal-content">
            <div class="modal-body">
                <span class="danger">Please select the file in <strong>CSV</strong> format</span>
                <br>
                <span class="danger">If you dont have file please download the file by Clicking the Button
                    <strong>Export</strong> CSV</span>
                <br>
                <br>
                <input type="file" (change)="fileChangeListener($event)">
                <br>
                <span style="color: red;">{{fileReadError}}</span>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" #testResultClosebutton
                    data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" (click)="uploadResult()">Upload Result</button>
            </div>
        </div>
    </div>
</div>
<!-- single result edit -->
<div class="modal fade" id="editSingleResult" tabindex="-1" role="dialog" aria-labelledby="importCSVModal"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-header">
            <h5 class="modal-title">Update Result</h5>
        </div>
        <div class="modal-content">
            <div class="modal-body">
                <div class="row">
                    <div class="col-lg-12">
                        <span *ngIf="selectedResult">Student ID : <strong>{{selectedResult.user_id}}</strong></span>
                    </div>
                    <br>
                    <div class="col-lg-12">
                        <span *ngIf="selectedResult">Student Name : <strong>{{selectedResult.name}}</strong></span>
                    </div>
                    <br>
                    <div class="form-group" *ngIf="selectedResult">
                        <label for="result" class="control-label col-lg-2">Result <span
                                class="required">*</span></label>
                        <div class="col-lg-10">
                            <input type="text" class="form-control" [(ngModel)]="selectedResult.result">

                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" #testSigleResultClosebutton
                    data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" (click)="updateSingleResult()">Update Result</button>
            </div>
        </div>
    </div>
</div>